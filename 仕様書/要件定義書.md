# 要件定義書

## 1. プロジェクト概要

### 1.1 システム名称
封口体アンドン#1,2

### 1.2 ドキュメント作成日
2025-12-08

### 1.3 バージョン
1.0

---

## 2. 目的・背景

### 2.1 プロジェクトの目的
作業者が現在の装置情報を見る機能を提供する。

### 2.2 解決する課題
装置情報が適切に切り分かっていなかった問題を解決する。

### 2.3 期待される効果
- 装置情報の可視化により、作業者が装置の状態を即座に把握できる
- 適切な情報の切り分けにより、状況判断が容易になる

---

## 3. 対象ユーザー

### 3.1 ユーザー
現場作業者

### 3.2 利用環境
工場の製造現場（大型ディスプレイ）

---

## 4. システム概要

### 4.1 システム概要
PLCから取得した装置情報をJSON形式で受け取り、工場の大型ディスプレイに装置ステータスとプロセス回数をリアルタイム表示するアンドンシステム。

### 4.2 システム構成
- アプリケーション形態: Blazor Server
- 実行環境: Windows（デスクトップアプリに近い使い方）
- データ取得方式: ローカルJSONファイル読み込み

### 4.3 対象装置
- 封口体装置 #1, #2（2台）
- ただし、プロセスは1つずつに分けるため、実質1台分のプロセスを表示

---

## 5. 機能要件

### 5.1 データ取得機能
- **機能ID**: FR-001
- **機能名**: JSONファイル読み込み機能
- **説明**: ローカルに配置されたJSONファイルから装置情報を取得する
- **詳細**:
  - ファイル名: `application.json`（固定）
  - 配置場所: ローカルディレクトリ
  - 更新頻度: 1秒ごとに読み込み
  - データ形式: JSON形式（PLCデータ）

### 5.2 装置ステータス表示機能
- **機能ID**: FR-002
- **機能名**: 装置ステータス表示機能
- **説明**: 装置の現在のステータスを表示する
- **詳細**:
  - 表示するステータス:
    - 稼働
    - 異常
    - 待機
  - 表示方法: 別途指示

### 5.3 プロセス回数表示機能
- **機能ID**: FR-003
- **機能名**: プロセス回数表示機能
- **説明**: JSONデータに含まれる処理回数を表示する
- **詳細**:
  - 表示する回数: JSONデータ内のプロセス処理回数
  - 表示方法: 別途指示

### 5.4 画面表示機能
- **機能ID**: FR-004
- **機能名**: 画面表示機能
- **説明**: 装置情報を大型ディスプレイに表示する
- **詳細**:
  - 表示デバイス: 工場の大型ディスプレイ
  - 画面レイアウト: 別途指示
  - 更新頻度: 1秒ごとにデータを更新表示

### 5.5 エラー通知機能
- **機能ID**: FR-005
- **機能名**: 通信異常警告機能
- **説明**: JSONファイルの読み込みに失敗した場合に警告を表示する
- **詳細**:
  - 判定条件: 1分以上（60秒以上）連続して読み込みに失敗した場合
  - 警告内容: 「通信異常」を表示
  - 警告表示方法: 別途指示

---

## 6. 非機能要件

### 6.1 可用性
- **要件ID**: NFR-001
- **要件名**: 24時間稼働
- **説明**: システムは24時間連続稼働する
- **目標値**: 稼働率 99%以上

### 6.2 パフォーマンス
- **要件ID**: NFR-002
- **要件名**: リアルタイム更新
- **説明**: 1秒ごとのデータ更新をスムーズに処理する
- **目標値**:
  - データ読み込み: 1秒以内
  - 画面更新: 遅延なく表示

### 6.3 信頼性
- **要件ID**: NFR-003
- **要件名**: エラー検知
- **説明**: データ読み込みエラーを適切に検知し、ユーザーに通知する
- **目標値**:
  - エラー検知時間: 1分（60秒）
  - エラー通知: 即座に表示

### 6.4 保守性
- **要件ID**: NFR-004
- **要件名**: ログ記録
- **説明**: システムの動作状況やエラー情報をログに記録する（推奨）
- **詳細**:
  - エラー発生時刻
  - ファイル読み込み失敗の記録

---

## 7. データ仕様

### 7.1 JSONデータ構造

#### 7.1.1 データ項目
- `items[]`: 配列形式
  - `device.number`: string（必須） - デバイス番号
  - `digits`: integer（必須、1以上） - 桁数
  - `unit`: string（必須） - データ単位
    - 値: "bit", "word", "dword"
  - `value`: number または array - データ値
    - unit が "bit" のとき: 0/1（単一値）
    - unit が "word"/"dword" のとき: string, int16/int32, uint16/uint32, float16/float32（単一値）

#### 7.1.2 データ例
```json
{
  "items": [
    {
      "device": {
        "number": "D100"
      },
      "digits": 1,
      "unit": "word",
      "value": 1
    },
    {
      "device": {
        "number": "M0"
      },
      "digits": 1,
      "unit": "bit",
      "value": 0
    }
  ]
}
```

### 7.2 データ取得元
- データ提供元: PLC（Programmable Logic Controller）
- データ形式: JSON
- ファイル名: `application.json`
- 更新間隔: 1秒ごと

---

## 8. 制約事項

### 8.1 技術的制約
- 開発技術: Blazor Server
- プラットフォーム: Windows
- .NETバージョン: 別途決定
- データ取得方式: ローカルJSONファイル読み込みのみ

### 8.2 運用上の制約
- JSONファイルは常にローカルディレクトリに配置される必要がある
- ファイル名は `application.json` 固定
- 大型ディスプレイでの表示を想定

### 8.3 その他の制約
- インターネット接続は不要（ローカル完結）
- データベースは使用しない

---

## 9. 用語定義

| 用語 | 定義 |
|------|------|
| アンドン | 製造現場で使用される視覚的な管理ツール。装置の状態や生産状況をリアルタイムで表示する |
| PLC | Programmable Logic Controller（プログラマブルロジックコントローラ）。製造装置を制御するコンピュータ |
| 封口体 | 製造プロセスにおける封口処理を行う装置 |
| プロセス回数 | 装置が処理を行った回数 |
| 通信異常 | JSONファイルの読み込みが1分以上連続して失敗した状態 |

---

## 10. 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| 作成者 |      | 2025-12-08 |      |
| 確認者 |      |        |      |
| 承認者 |      |        |      |

---

## 11. 変更履歴

| バージョン | 日付 | 変更者 | 変更内容 |
|------------|------|--------|----------|
| 1.0 | 2025-12-08 | - | 初版作成 |
